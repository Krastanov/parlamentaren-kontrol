<%include file="header.html" args="title='${title}'"/>


<!-- ##################################################################### -->
<!-- ##################################################################### -->
<h1>Стенограма от ${stenogram.date.strftime('%d/%m/%Y')}</h1>

<hr class="alt1" />


<!-- ##################################################################### -->
<!-- ##################################################################### -->
<h2>Регистрация</h2>

<div class="col_6">
<table class="sortable">
    <thead><tr>
        <th>Партия</th>
        <th>Присъстващи</th>
        <th>Отсъстващи</th>
        <th>Отсъстващи %</th>
        <th>Общо Регистрирани</th>
    </tr></thead>
    
    <tbody>
    % for party, reg_stat in stenogram.reg_by_party_dict.items():
        <tr>
            <td>${party}</td>
            <td>${reg_stat.present}</td>
            <td>${reg_stat.expected-reg_stat.present}</td>
            <td class="percentage">${int(100*float(reg_stat.expected-reg_stat.present)/reg_stat.expected)}</td>
            <td>${reg_stat.expected}</td>
        </tr>
    % endfor
    </tbody>
</table>
<% total = map(sum, zip(*stenogram.reg_by_party_dict.values())) %>
<p><strong>Всички Партии</strong>: Присъстващи: ${total[0]}, Общо регистрирани: ${total[1]}</p>
</div>

<div class="col_6">
    <img class="full-width" src="registration${stenogram.date.strftime('%Y%m%d')}.png" alt="Регистрирани и отсъстващи депутати."/>
</div>

<hr class="alt1" />


<!-- ##################################################################### -->
<!-- ##################################################################### -->
<h2>Гласувания</h2>

<div class="col_6">
<h3>Съдържание</h3>
    <p>
    Отиди директно на гласуване номер: <br />
    ${', '.join(['<a href="#vote%d"><span class="tooltip-bottom" title="%s">%d</span></a>'%(i+1, s.description, i+1) for i, s in enumerate(stenogram.sessions)])}
    </p>
</div>
<div class="col_6">
<img class="full-width" src="absences${stenogram.date.strftime('%Y%m%d')}.png" alt="Отсъствия на депутати."/>
</div>

<div class="col_12 "id="sessions">

% for i, session in enumerate(stenogram.sessions):
    % if i:
        <hr />
    % endif

    <h3 id="vote${i+1}"><a href="#vote${i+1}">Гласуване ${i+1}</a></h3>

    <div class="col_6"><blockquote>${session.description}</blockquote></div>
    <div class="col_6"><img class="full-width" src="session${stenogram.date.strftime('%Y%m%d')}votes${i+1}.png" alt="Гласували и отсъстващи депутати."/></div>

    <div class="col_12">
        <button class="small" id="showSession${i+1}" onClick="toggle('session${i+1}','showSession${i+1}','Покажи таблица', 'Скрий');" >Покажи таблица</button>
        <a class="small" href="#votesInText${i+1}">Намери в текста</a>
    </div>
    <div class="col_12 "id="session${i+1}" style="display: none;">

    <table class="sortable">
        <thead><tr>
            <th>Партия</th>
            <th>За</th>
            <th>Против</th>
            <th>Въздържали се</th>
            <th>Общо Гласували</th>
            <th>Не Гласували</th>
        </tr></thead>

        <tbody>
        % for party, vote_stat in session.votes_by_party_dict.items():
            <tr>
                <td>${party}</td>
                <td>${vote_stat.yes}</td>
                <td>${vote_stat.no}</td>
                <td>${vote_stat.abstained}</td>
                <td>${vote_stat.total}</td>
                <td>${stenogram.reg_by_party_dict[party].expected - (vote_stat.yes + vote_stat.no + vote_stat.abstained)}</td>
            </tr>
        % endfor
        </tbody>
    </table>

    <% total = map(sum, zip(*session.votes_by_party_dict.values())) %>
    <p><strong>Всички Партии</strong>: За: ${total[0]}, Против: ${total[1]}, Въздържали се: ${total[2]}, Общо Гласували: ${total[3]}</p>
    </div>

% endfor
</div>

<hr class="alt1" />


<!-- ##################################################################### -->
<!-- ##################################################################### -->
<h2>Пълен Текст</h2>

<p>
<% count = 1 %>
% for i, line in enumerate(stenogram.text_lines):
    % if i in stenogram.in_text_votes:
        <strong id="votesInText${count}">${line}</strong>
        <% count += 1 %>
    % else:
        ${line}
    % endif
    <br />
% endfor
</p>


<%include file="footer.html" />
